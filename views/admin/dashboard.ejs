<%- include('../layout/adminHeadder.ejs') %>

       
<section class="content-main">
    <div class="content-header">
        <div>
            <h2 class="content-title card-title">Dashboard</h2>
            <p>Whole data about your business here</p>
        </div>
        <div>
            <a href="/admin/sales-report" class="btn btn-primary"><i class="text-muted material-icons md-post_add"></i>Create report</a>
        </div>
    </div>
    <div class="row">
        <div class="col-lg-3">
            <div class="card card-body mb-4">
                <article class="icontext">
                    <span class="icon icon-sm rounded-circle bg-primary-light">
                        <i class="text-primary material-icons md-monetization_on"></i>
                    </span>
                    <div class="text">
                        <h6 class="mb-1 card-title">Revenue</h6>
                        <span>$<%= overallOrderAmount.toFixed(2) %></span>
                        <span class="text-sm"> Shipping fees are included </span>
                    </div>
                </article>
            </div>
        </div>
        <div class="col-lg-3">
            <div class="card card-body mb-4">
                <article class="icontext">
                    <span class="icon icon-sm rounded-circle bg-success-light">
                        <i class="text-success material-icons md-local_shipping"></i>
                    </span>
                    <div class="text">
                        <h6 class="mb-1 card-title">Orders</h6>
                        <span><%= overallSalesCount %></span>
                        <span class="text-sm"> Excluding orders in transit </span>
                    </div>
                </article>
            </div>
        </div>
        <div class="col-lg-3">
            <div class="card card-body mb-4">
                <article class="icontext">
                    <span class="icon icon-sm rounded-circle bg-warning-light"><i class="text-warning material-icons md-qr_code"></i></span>
                    <div class="text">
                        <h6 class="mb-1 card-title">Products</h6>
                        <span>9.856</span>
                        <span class="text-sm"> In 19 Categories </span>
                    </div>
                </article>
            </div>
        </div>
        <div class="col-lg-3">
            <div class="card card-body mb-4">
                <article class="icontext">
                    <span class="icon icon-sm rounded-circle bg-info-light">
                        <i class="text-info material-icons md-shopping_basket"></i>
                    </span>
                    <div class="text">
                        <h6 class="mb-1 card-title">Monthly Earning</h6>
                        <span>$<%= monthlyEarnings.toFixed(2) %></span>
                        <span class="text-sm"> Based in your local time. </span>
                    </div>
                </article>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-xl-8 col-lg-12">
            <div class="card mb-4">
                <article class="card-body">
                    <h5 class="card-title">Top Selling Products</h5>
                    <canvas id="topProductsChart" width="400" height="200px"></canvas>
                    <div id="topTenProductsData" style="display: none;"><%= topTenProducts %></div>
                    <canvas id="myChart" height="120px"></canvas>
                </article>
                <!-- <script>
                    document.addEventListener("DOMContentLoaded", function() {
                      const topTenProductsData = document.getElementById('topTenProductsData').textContent;
                      try {
                        const topTenProducts = JSON.parse(topTenProductsData);
                
                        const renderTopProductsChart = (productNames, productQuantitiesSold) => {
                          const ctx = document.getElementById('topProductsChart').getContext('2d');
                          const topProductsChart = new Chart(ctx, {
                            type: 'bar',
                            data: {
                              labels: productNames,
                              datasets: [{
                                label: 'Quantity Sold',
                                data: productQuantitiesSold,
                                backgroundColor: 'rgba(54, 162, 235, 0.5)', // Blue color with transparency
                                borderColor: 'rgba(54, 162, 235, 1)', // Blue color
                                borderWidth: 1
                              }]
                            },
                            options: {
                              scales: {
                                y: {
                                  beginAtZero: true
                                }
                              }
                            }
                          });
                        };
                
                        // Render the chart with the data
                        renderTopProductsChart(topTenProducts.productNames, topTenProducts.productQuantitiesSold);
                      } catch (e) {
                        console.error("Failed to parse top ten products data:", e);
                      }
                    });
                  </script> -->
            </div>
        </div>
        <div class="col-xl-4 col-lg-12">
            <div class="card mb-4">
                <article class="card-body">
                    <h5 class="card-title">Revenue Base on Area</h5>
                    <canvas id="topCategoriesChart" width="400" height="400"></canvas>
                    <div id="topTenCategoriesData" style="display: none;"><%= topTenCategories %></div>
                    <!-- <canvas id="myChart2" height="217"></canvas> -->
                </article>
                <script>
                    document.addEventListener("DOMContentLoaded", function() {
                      const topTenProductsData = document.getElementById('topTenProductsData').textContent;
                      const topTenCategoriesData = document.getElementById('topTenCategoriesData').textContent;
                
                      let topProductsChart, topCategoriesChart;
                
                      try {
                        const topTenProducts = JSON.parse(topTenProductsData);
                        const topTenCategories = JSON.parse(topTenCategoriesData);
                
                        const renderTopProductsChart = (productNames, productQuantitiesSold) => {
                          if (topProductsChart) {
                            topProductsChart.destroy(); 
                          }
                          console.log('product: ', productQuantitiesSold);
                          const ctx = document.getElementById('topProductsChart').getContext('2d');
                          topProductsChart = new Chart(ctx, {
                            type: 'bar',
                            data: {
                              labels: productNames,
                              datasets: [{
                                label: 'Quantity Sold',
                                data: productQuantitiesSold,
                                backgroundColor: 'rgba(54, 162, 235, 0.5)', // Blue color with transparency
                                borderColor: 'rgba(54, 162, 235, 1)', // Blue color
                                borderWidth: 1
                              }]
                            },
                            options: {
                              scales: {
                                y: {
                                  beginAtZero: true
                                }
                              }
                            }
                          });
                        };
                
                        const renderTopCategoriesChart = (categoryNames, categoryQuantitiesSold) => {
                        if (topCategoriesChart) {
                            topCategoriesChart.destroy(); 
                        }
                        
                        console.log('asdfasdf',categoryQuantitiesSold);
                        const ctx = document.getElementById('topCategoriesChart').getContext('2d');
                        topCategoriesChart = new Chart(ctx, {
                            type: 'bar',
                            data: {
                            labels: categoryNames,
                            datasets: [{
                                label: 'Quantity Sold',
                                data: categoryQuantitiesSold,
                                backgroundColor: 'rgba(75, 192, 192, 0.5)', // Teal color with transparency
                                borderColor: 'rgba(75, 192, 192, 1)', // Teal color
                                borderWidth: 1
                            }]
                            },
                            options: {
                            scales: {
                                y: {
                                beginAtZero: true
                                }
                            }
                            }
                        });
                        };
                
                        // Render the charts with the data
                        renderTopProductsChart(topTenProducts.productNames, topTenProducts.productQuantitiesSold);
                        renderTopCategoriesChart(topTenCategories.categoryNames, topTenCategories.categoryQuantitiesSold);
                    } catch (e) {
                        console.error("Failed to parse data:", e);
                      }
                    });
                  </script>
            </div>
            <div class="card mb-4">
                <!-- <article class="card-body">
                    <h5 class="card-title">Marketing Chanel</h5>
                    <span class="text-muted font-xs">Facebook</span>
                    <div class="progress mb-3">
                        <div class="progress-bar" role="progressbar" style="width: 15%">15%</div>
                    </div>
                    <span class="text-muted font-xs">Instagram</span>
                    <div class="progress mb-3">
                        <div class="progress-bar" role="progressbar" style="width: 65%">65%</div>
                    </div>
                    <span class="text-muted font-xs">Google</span>
                    <div class="progress mb-3">
                        <div class="progress-bar" role="progressbar" style="width: 51%">51%</div>
                    </div>
                    <span class="text-muted font-xs">Twitter</span>
                    <div class="progress mb-3">
                        <div class="progress-bar" role="progressbar" style="width: 80%">80%</div>
                    </div>
                    <span class="text-muted font-xs">Other</span>
                    <div class="progress mb-3">
                        <div class="progress-bar" role="progressbar" style="width: 80%">80%</div>
                    </div>
                </article> -->
            </div>
        </div>
    </div>
    <div class="pagination-area mt-30 mb-50">
        <nav aria-label="Page navigation example">
            <ul class="pagination justify-content-start">
                <li class="page-item active"><a class="page-link" href="#">01</a></li>
                <li class="page-item"><a class="page-link" href="#">02</a></li>
                <li class="page-item"><a class="page-link" href="#">03</a></li>
                <li class="page-item"><a class="page-link dot" href="#">...</a></li>
                <li class="page-item"><a class="page-link" href="#">16</a></li>
                <li class="page-item">
                    <a class="page-link" href="#"><i class="material-icons md-chevron_right"></i></a>
                </li>
            </ul>
        </nav>
    </div>
</section>
<!-- content-main end// -->             

<!-- footer -->
<%- include('../layout/adminFooter.ejs') %>
